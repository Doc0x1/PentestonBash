#!/bin/bash
# PentestonBash plugin setup script

current_dir=$(pwd)
repo_dir=$(dirname "${BASH_SOURCE[0]}")

# Check to make sure we are in the correct directory
if [ "$current_dir" != "$repo_dir" ]; then
  printf "This script must be run from the cloned repository directory.\n"
  printf "Current directory: %s\n" "$current_dir"
  printf "Repository directory: %s\n" "$repo_dir"
  exit 1
fi

printf "Installing PentestonBash plugin...\n"
# Check to make sure .pentestonbash file exists in the directory, if so, copy it to the user's home directory
if [ -f "./.pentestonbash" ]; then
  cp .pentestonbash ~/.pentestonbash
else
  printf "File .pentestonbash not found. Please ensure the repository is cloned correctly.\n" && exit 1
fi

printf "Sourcing .pentestonbash in user's .bashrc file...\n"
# Source the plugin in the user's .bashrc file
echo -e "\nsource ~/.pentestonbash\n" >> ~/.bashrc

printf "Install complete!\n"
printf "Restart your terminal to see the changes applied, or run `source ~/.bashrc` to do so immediately.\n"